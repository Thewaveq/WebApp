:root {
  /* Доп. системные переменные, не переопределяют существующие переменные в original styles.css */
  --space-unit: 0.75rem;            /* базовый отступ */
  --card-radius: 0.75rem;           /* радиус у карточек и панелей */
  --soft-elevation: 0 8px 24px rgba(0,0,0,0.45); /* мягкая тень */
  --glass-surface: rgba(255,255,255,0.03);
}

/* Мелкие общие улучшения */
html, body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
body { font-weight: 300; letter-spacing: -0.01em; }

/* Улучшаем вид панели навигации */
nav.h-12 { height: 3rem; }
.main-nav-item {
  padding: 0.45rem 0.65rem; /* чуть компактнее, аккуратные пиллы */
  border-radius: 0.5rem;
  transition: transform 180ms ease, background-color 180ms ease, box-shadow 180ms ease;
}
.main-nav-item:hover { transform: translateY(-2px); box-shadow: var(--soft-elevation); }
.main-nav-item.active { box-shadow: 0 6px 18px rgba(0,0,0,0.4); }

/* SIDEBAR — более «плоский», но с глубиной */
#sidebar {
  padding: calc(var(--space-unit) * 0.6) 0.5rem 0.75rem 0.5rem; /* немного воздуха */
  border-right: 1px solid rgba(255,255,255,0.04);
  -webkit-backdrop-filter: blur(6px);
  backdrop-filter: blur(6px);
}
#sidebar .h-12 { padding-left: 1rem; padding-right: 0.75rem; }
#sidebar .text-xl { font-weight: 600; letter-spacing: -0.02em; }

/* Элементы списка в сайдбаре */
.sidebar-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.6rem 0.8rem;
  border-radius: 0.6rem;
  transition: background-color 180ms ease, transform 180ms ease, box-shadow 220ms ease;
}
.sidebar-item:not(.active):hover { transform: translateX(4px); box-shadow: 0 6px 18px rgba(0,0,0,0.32); }
.sidebar-item.active {
  border-left: 3px solid rgba(var(--user-accent-rgb), 0.95);
  box-shadow: 0 8px 28px rgba(var(--user-accent-rgb), 0.035);
  background: linear-gradient(180deg, rgba(255,255,255,0.015), transparent);
}

/* Кнопки "Новый чат" и др — делаем более аккуратные пиллы */
#new-chat-btn, #new-note-btn, #new-diagram-btn {
  border-radius: 0.65rem;
  padding: 0.5rem 0.875rem;
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
  transition: transform 140ms ease, box-shadow 200ms ease;
}
#new-chat-btn:active { transform: scale(0.995); }

/* Плавающие кнопки управления чатом — плавный современный стиль */
.chat-action-btn {
  border-radius: 0.6rem;
  padding: 0.45rem;
  min-width: 40px;
  min-height: 40px;
  box-shadow: 0 8px 22px rgba(0,0,0,0.45);
  transition: transform 150ms ease, box-shadow 200ms ease, background-color 160ms ease;
}
.chat-action-btn:hover { transform: translateY(-4px); }
.chat-action-btn.active { transform: translateY(-1px) scale(1.02); }

/* Панели настроек — немного более выразительный glass-эффект */
#chat-settings-panel, #notepad-settings-panel {
  border-radius: var(--card-radius);
  box-shadow: 0 18px 40px rgba(0,0,0,0.55);
  border: 1px solid rgba(255,255,255,0.06);
}

/* Плавные появление/исчезновение — избегаем pointer-events:none при анимации */
#chat-settings-panel[style], #notepad-settings-panel[style] { will-change: opacity, transform; }

/* Индикаторы и типографика внутри сообщений */
.prose { line-height: 1.6; font-size: 0.98rem; }
.prose h1, .prose h2, .prose h3 { letter-spacing: -0.02em; margin-top: 1rem; margin-bottom: 0.6rem; }
.prose pre { border-radius: 0.6rem; padding: 0.85rem; }
.prose code { font-size: 0.9em; }

/* Карточки заметок */
.note-card { border-radius: var(--card-radius); padding: 1rem; }
.note-card:hover { transform: translateY(-6px); box-shadow: 0 18px 36px rgba(0,0,0,0.45); }

/* Форма ввода — виднее и аккуратнее */
#chat-form { padding: 0.75rem; }
#chat-input { border-radius: 0.6rem; padding: 0.7rem; min-height: 48px; max-height: 240px; }

/* Модалки — центр и фокус */
.modal-content { border-radius: 1rem; }
.modal-overlay { background-color: rgba(0,0,0,0.6); }

/* Уведомление in-app — деликатное свечение */
#in-app-notification > div { animation: none; box-shadow: 0 12px 30px rgba(0,0,0,0.55); }

/* Скроллбар — добавим совместимость для firefox */
* { scrollbar-color: var(--base-dark-500) var(--bg-sidebar); }

/* Фокус-видимый для доступности */
:focus { outline: none; }
:focus-visible { outline: 3px solid rgba(var(--user-accent-rgb),0.95); outline-offset: 3px; border-radius: 0.35rem; }

/* Мобильные корректировки */
@media (max-width: 640px) {
  .sidebar-item { padding: 0.5rem; }
  .chat-action-btn { min-width: 36px; min-height: 36px; }
}

/* Неинвазивные утилитарные классы (без изменения существ. логики) */
.u-elevate { box-shadow: var(--soft-elevation); border-radius: var(--card-radius); }
.u-pill { border-radius: 999px; padding: 0.35rem 0.75rem; }

/* Безопасные правила переопределения для известных селекторов — гарантия совместимости: */
#sidebar.open { transform: translateX(0); }
#sidebar.collapsed { width: 56px; }

/* Маленькие полировки: иконки Lucide наследуют цвет */
[i[data-lucide]] svg { color: inherit; }
