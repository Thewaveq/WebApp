        function setupNotepadViewEventListeners() {
            const titleInput = document.getElementById('note-title-input');
            const contentTextarea = document.getElementById('note-content-textarea');

            // Функция для сохранения заметки
            const saveNote = () => {
                // Проверяем, есть ли активная сессия, чтобы избежать ошибок
                if (!state.activeSessionId) return;

                const sessionRef = doc(db, `artifacts/${appId}/users/${userId}/sessions`, state.activeSessionId);
                updateDoc(sessionRef, {
                    title: titleInput.value,
                    content: contentTextarea.value,
                    updatedAt: serverTimestamp()
                });
            };

            // Сохраняем заметку, когда пользователь убирает фокус с поля (например, нажимает в другом месте)
            titleInput?.addEventListener('blur', saveNote);
            contentTextarea?.addEventListener('blur', saveNote);
        }
